<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { background: #050505; color: white; font-family: 'Inter', sans-serif; }
        .glass { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.08); backdrop-filter: blur(10px); }
    </style>
</head>
<body class="p-8">
    <div class="max-w-4xl mx-auto">
        <header class="flex justify-between items-center mb-12">
            <h1 class="text-2xl font-black italic">ADMIN<span class="text-blue-500">VAULT</span></h1>
            <a href="dash.html" class="text-xs text-gray-500 hover:text-white uppercase tracking-widest">Retour Dashboard</a>
        </header>

        <h2 class="text-lg font-semibold mb-6 flex items-center gap-2">
            <i data-lucide="bell-ring" class="text-blue-500"></i> Demandes de mise Ã  niveau
        </h2>

        <div id="requestList" class="space-y-4">
            </div>
    </div>

    <script>
        const API_URL = "https://TON_URL_NGROK.ngrok-free.app";
        const TOKEN = localStorage.getItem('vault_token');

        async function loadRequests() {
            const res = await fetch(`${API_URL}/admin/requests`, { headers: {'Authorization': TOKEN} });
            const reqs = await res.json();
            const container = document.getElementById('requestList');
            
            container.innerHTML = reqs.length ? reqs.map(r => `
                <div class="glass p-6 rounded-[24px] flex justify-between items-center animate-in fade-in slide-in-from-bottom-2">
                    <div>
                        <p class="font-bold text-lg">${r.username}</p>
                        <p class="text-sm text-blue-400">Souhaite passer au plan : <span class="font-bold">${r.requestedPlan}</span></p>
                    </div>
                    <div class="flex gap-3">
                        <button onclick="process('${r.id}', 'accept')" class="bg-blue-600 hover:bg-blue-500 px-5 py-2 rounded-xl text-sm font-bold transition">Accepter</button>
                        <button onclick="process('${r.id}', 'decline')" class="bg-white/5 hover:bg-white/10 px-5 py-2 rounded-xl text-sm font-bold transition">Refuser</button>
                    </div>
                </div>
            `).join('') : '<p class="text-gray-600 italic">Aucune demande en attente...</p>';
            lucide.createIcons();
        }

        async function process(requestId, action) {
            await fetch(`${API_URL}/admin/process`, {
                method: 'POST',
                headers: { 'Authorization': TOKEN, 'Content-Type': 'application/json' },
                body: JSON.stringify({ requestId, action })
            });
            loadRequests();
        }

        loadRequests();
    </script>
</body>
</html>
